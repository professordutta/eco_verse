{% extends 'mriic/base.html' %}
{% load static %}
{% block title %}Create Lesson | EcoVerse Learn{% endblock %}
{% block content %}
<div class="container my-4">
  <div class="d-flex justify-content-between align-items-center mb-3">
    <h2 class="mb-0 fw-bold text-success">Create Lesson</h2>
    <a href="{% url 'learning:lesson_list' %}" class="btn btn-outline-secondary btn-sm">Back to Lessons</a>
  </div>
  <div class="card shadow-sm border-0">
    <div class="card-body p-4">
      <form method="post" enctype="multipart/form-data" novalidate>
        {% csrf_token %}
        {% if messages %}
          {% for message in messages %}
            <div class="alert alert-{{ message.tags }} py-2 mb-2">{{ message }}</div>
          {% endfor %}
        {% endif %}
        <div class="row g-3">
          <div class="col-12">
            <label class="form-label fw-semibold">Title</label>
            {{ form.title }}
            {% if form.title.errors %}<div class="text-danger small">{{ form.title.errors.0 }}</div>{% endif %}
          </div>
          <div class="col-12">
            <label class="form-label fw-semibold">Short Description</label>
            {{ form.short_description }}
            {% if form.short_description.errors %}<div class="text-danger small">{{ form.short_description.errors.0 }}</div>{% endif %}
          </div>
          <div class="col-12">
            <label class="form-label fw-semibold">Inline HTML Content (optional)</label>
            {{ form.html_content }}
            <div class="form-text">Provide rich HTML if no SCORM package is supplied.</div>
            {% if form.html_content.errors %}<div class="text-danger small">{{ form.html_content.errors.0 }}</div>{% endif %}
          </div>
          <div class="col-md-4">
            <label class="form-label fw-semibold">Cover Image</label>
            {{ form.cover_image }}
            <div class="form-text">PNG/JPG image representing the lesson.</div>
            {% if form.cover_image.errors %}<div class="text-danger small">{{ form.cover_image.errors.0 }}</div>{% endif %}
          </div>
          <div class="col-md-4">
            <label class="form-label fw-semibold">Video URL</label>
            {{ form.video_url }}
            <div class="form-text">YouTube/Vimeo or direct MP4 URL.</div>
            {% if form.video_url.errors %}<div class="text-danger small">{{ form.video_url.errors.0 }}</div>{% endif %}
          </div>
          <div class="col-md-4">
            <label class="form-label fw-semibold">Resource File</label>
            {{ form.resource_file }}
            <div class="form-text">Optional PDF or supplementary file.</div>
            {% if form.resource_file.errors %}<div class="text-danger small">{{ form.resource_file.errors.0 }}</div>{% endif %}
          </div>
          <div class="col-md-6">
            <label class="form-label fw-semibold">SCORM Package (zip)</label>
            {{ form.scorm_package }}
            {% if form.scorm_package.errors %}<div class="text-danger small">{{ form.scorm_package.errors.0 }}</div>{% endif %}
          </div>
          <div class="col-md-3">
            <label class="form-label fw-semibold">Eco Points</label>
            {{ form.eco_points }}
            {% if form.eco_points.errors %}<div class="text-danger small">{{ form.eco_points.errors.0 }}</div>{% endif %}
          </div>
          <div class="col-md-3 d-flex align-items-center mt-4 pt-2">
            <div class="form-check">
              {{ form.is_published }}
              <label class="form-check-label">Published</label>
            </div>
          </div>
        </div>
        <hr class="my-4"/>
        <div class="d-flex justify-content-end gap-2">
          <button type="reset" class="btn btn-outline-secondary">Reset</button>
          <button type="submit" class="btn btn-success px-4">Save Lesson</button>
        </div>
      </form>
    </div>
  </div>
</div>
{% endblock %}
{% block extra_js %}
<script src="https://cdn.tiny.cloud/1/9rdo9hsgtc0qmqq8d30vx9jnhjhafezif6vc786lqesese4g/tinymce/7/tinymce.min.js" referrerpolicy="origin"></script>
<script>
  tinymce.init({
    selector: 'textarea[name=html_content]',
    menubar: false,
    plugins: 'link lists media code table',
    toolbar: 'styles | bold italic underline | bullist numlist | link media table | code',
    height: 400,
    branding: false,
    content_css: false,
    skin: 'oxide'
  });
</script>
{% endblock %}
